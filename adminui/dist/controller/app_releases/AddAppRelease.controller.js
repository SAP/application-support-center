sap.ui.define(["../BaseController"],function(e){var t;return e.extend("asc.admin.controller.app_releases.AddAppRelease",{onInit:function(){var e=this;this.oRouter=this.getOwnerComponent().getRouter();t=new sap.ui.model.json.JSONModel("model/app_release.json");this.getView().setModel(t,"app_release");sap.ui.require(["sap/ui/richtexteditor/RichTextEditor","sap/ui/richtexteditor/EditorType"],function(t,a){var i=new t("idRichNewAppReleaseDescription",{editorType:a.TinyMCE4,width:"90%",height:"300px",customToolbar:true,showGroupFont:false,showGroupLink:true,showGroupInsert:false,value:"{app_release>/description}",ready:function(){this.addButtonGroup("styleselect").addButtonGroup("table");this.addStyleClass("formattedTextPadding")}});e.getView().byId("idVerticalLayout").addContent(i)});this.oRouter.getRoute("addapprelease").attachPatternMatched(this._onReleaseMatched,this)},_onReleaseMatched:function(e){this._app=e.getParameter("arguments").app||this._app||"0";this._appDetail=this.getView().getModel("apps").oData[this._app]},onCancelPress:function(){this.oRouter.navTo("editapp",{app:this._app})},onSavePress:function(e){this.api.postNewAppRelease(this._appDetail.app_id,this.getView().getModel("app_release").getData()).done(this.onSaveReleaseDone.bind(this)).fail(this.onHTTPFail.bind(this))},onSaveReleaseDone:function(e){this.onToast("Success!");var t=this.getView().oPropagatedProperties.oModels.app_releases;t.getData().splice(0,0,e.data);t.setData(t.getData());if(this.getOwnerComponent().getModel("selected_app").getData().technology==="iOS"){this.oRouter.navTo("editapprelease",{app:this._app,app_release:0})}else{this.oRouter.navTo("editapp",{app:this._app})}}})},true);